<div class="p-4">
  <div class="mb-3 flex items-center gap-2">
    <button *ngIf="_userDetails?.Roles == 'Mentor'" 
            mat-raised-button 
            class="bg-primary rounded-full flex items-center gap-2 text-white" 
            (click)="AssignTask()">
      <mat-icon>add</mat-icon>Add New
    </button>
    <div>
      <mat-button-toggle-group name="fontStyle" value="TableView" aria-label="Font Style">
        <mat-button-toggle routerLink="/task/list" value="TableView">
          <mat-icon>table_chart</mat-icon>Table View
        </mat-button-toggle>
        <mat-button-toggle routerLink="{{_userDetails?.Roles == 'Mentor' ? '/task/mentor-kanban' : '/task/kanban' }}" 
                          value="KanBan">
          <mat-icon>view_list</mat-icon>KanBan Board
        </mat-button-toggle>
        <mat-button-toggle routerLink="{{_userDetails?.Roles == 'Mentor' ? '/task/mentor-calendar' : '/task/calendar' }}" 
                          value="Calendar">
          <mat-icon>calendar_today</mat-icon>Calendar
        </mat-button-toggle>
      </mat-button-toggle-group>
    </div>
  </div>

  <mat-accordion multi="true">
    <!-- Active Tasks -->
    <mat-expansion-panel expanded="true">
      <mat-expansion-panel-header>
        <mat-panel-title>
          Active Tasks
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div class="table-container">
        <table mat-table [dataSource]="activeTasks" class="mat-elevation-z8 w-full">
          <!-- Task Column -->
          <ng-container matColumnDef="task">
            <th mat-header-cell *matHeaderCellDef> Task </th>
            <td mat-cell *matCellDef="let task"> {{ task.title }} </td>
          </ng-container>

          <ng-container matColumnDef="createdby">
            <th mat-header-cell *matHeaderCellDef> Assigned By </th>
            <td mat-cell *matCellDef="let task"> {{ task.createdBy || 'N/A' }} </td>
          </ng-container>

          <ng-container matColumnDef="createdon">
            <th mat-header-cell *matHeaderCellDef> Created On </th>
            <td mat-cell *matCellDef="let task"> {{ task.date | date:'MMM d, y' || 'N/A' }} </td>
          </ng-container>

          <!-- Action Column -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef> Action </th>
            <td mat-cell *matCellDef="let task">
              <div class="flex items-center gap-2">
                <mat-icon class="cursor-pointer" 
                         *ngIf="_userDetails?.Roles == 'Mentor'" 
                         (click)="edit(task)" 
                         routerLink="/task/edit/{{task.guid}}">
                  edit
                </mat-icon>
                <mat-icon class="cursor-pointer" 
                         (click)="showTask(task.guid)">
                  remove_red_eye
                </mat-icon>
                <button mat-raised-button 
                        *ngIf="_userDetails?.Roles == 'Mentor'" 
                        color="primary" 
                        (click)="markCompleted(task.guid)">
                  Mark Completed
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        
        <!-- Active Tasks Paginator -->
        <mat-paginator #activePaginator 
                      [pageSizeOptions]="[5, 10, 20]" 
                      [pageSize]="5"
                      showFirstLastButtons
                      aria-label="Select page of active tasks">
        </mat-paginator>
      </div>
    </mat-expansion-panel>

    <!-- Completed Tasks -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Completed Tasks
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div class="table-container">
        <table mat-table [dataSource]="completedTasks" class="mat-elevation-z8 w-full">
          <!-- Task Column -->
          <ng-container matColumnDef="task">
            <th mat-header-cell *matHeaderCellDef> Task </th>
            <td mat-cell *matCellDef="let task"> {{ task.title }} </td>
          </ng-container>

          <ng-container matColumnDef="createdby">
            <th mat-header-cell *matHeaderCellDef> Assigned By </th>
            <td mat-cell *matCellDef="let task"> {{ task.createdBy || 'N/A' }} </td>
          </ng-container>

          <ng-container matColumnDef="createdon">
            <th mat-header-cell *matHeaderCellDef> Created On </th>
            <td mat-cell *matCellDef="let task"> {{ task.date | date:'MMM d, y' || 'N/A' }} </td>
          </ng-container>

          <!-- Action Column -->
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef> Action </th>
            <td mat-cell *matCellDef="let task">
              <div class="flex items-center gap-2">
                <mat-icon class="cursor-pointer" 
                         *ngIf="_userDetails?.Roles == 'Mentor'" 
                         (click)="edit(task)" 
                         routerLink="/task/edit/{{task.guid}}">
                  edit
                </mat-icon>
                <mat-icon class="cursor-pointer" 
                         (click)="showTask(task.guid)">
                  remove_red_eye
                </mat-icon>
                <button mat-raised-button 
                        *ngIf="_userDetails?.Roles == 'Mentor'" 
                        color="primary" 
                        (click)="markActive(task.guid)">
                  Move to Active
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        
        <!-- Completed Tasks Paginator -->
        <mat-paginator #completedPaginator 
                      [length]="completedTasksPagination.totalCount"
                      [pageSize]="completedTasksPagination.pageSize"
                      [pageIndex]="completedTasksPagination.currentPage - 1"
                      [pageSizeOptions]="[5, 10, 20]" 
                      (page)="onCompletedPageChange($event)"
                      showFirstLastButtons
                      aria-label="Select page of completed tasks">
        </mat-paginator>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>

<!-- Drawer component remains the same -->
<fuse-drawer #drawer 
            class="z-999 w-screen min-w-screen sm:w-200 sm:min-w-200"
            fixed
            [mode]="'over'"
            [name]="'drawer'"
            [position]="'right'">
  <!-- Your existing drawer content -->
</fuse-drawer>

<app-view-task
  [isOpen]="showTaskModal"
  [taskId]="selectedTaskId"
  (close)="onSidePanelClose()">
</app-view-task>