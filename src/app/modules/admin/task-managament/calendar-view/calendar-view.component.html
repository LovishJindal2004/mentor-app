<div class="calendar-wrapper">
  <div class="calendar-toolbar">
    <div class="left">
      <button (click)="prevWeek()">‹</button>
      <button (click)="today()">Today</button>
      <button (click)="nextWeek()">›</button>
    </div>
    <div class="center">
      <div class="month-label" (click)="toggleDatePicker()" title="Pick a date">
        {{ days | date:'MMMM y' }}
      </div>
      <div class="date-picker" *ngIf="showDatePicker">
        <div class="dp-header">
          <button (click)="prevMonth()" class="dp-btn">‹</button>
          <div class="title">{{ monthLabel }}</div>
          <button (click)="nextMonth()" class="dp-btn">›</button>
        </div>
        <div class="dp-grid">
          <div class="dow" *ngFor="let d of ['Mon','Tue','Wed','Thu','Fri','Sat','Sun']">{{ d }}</div>
          <button class="day"
            *ngFor="let d of monthGrid"
            [class.muted]="!isSameMonth(d)"
            [class.today]="isToday(d)"
            (click)="selectDate(d)">{{ d.getDate() }}</button>
        </div>
      </div>
    </div>
  </div>

  <div class="week-grid">
    <div class="day-column" *ngFor="let day of days; let i = index">
      <div class="day-header">
        <div class="dow">{{ day | date:'EEE' }}</div>
        <div class="date">{{ day | date:'d' }}</div>
      </div>
      <div class="events">
        <div class="card" (click)="openViewTask(t.id)"
          *ngFor="let t of dayTasks[i]; let ti = index; trackBy: trackByTaskId"
          [style.border-left-color]="getTypeColor(t.typeId)">
          <div class="title-row">
            <div class="title">{{ t.title }}</div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <app-view-task
    [isOpen]="panelOpen"
    [taskId]="panelTaskId"
    (close)="closePanel()">
  </app-view-task>
</div>
